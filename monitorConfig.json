{"_id":"VwmVMY0B9msCxi8krJsM","_version":15,"_seq_no":55,"_primary_term":5,"monitor":{"type":"monitor","schema_version":8,"name":"Testing28","monitor_type":"query_level_monitor","enabled":true,"enabled_time":1705933908685,"schedule":{"period":{"interval":1,"unit":"MINUTES"}},"inputs":[{"search":{"indices":["metricbeat-2024.01.22"],"query":{"query":{"bool":{"filter":[{"exists":{"field":"system.memory.used.pct","boost":1.0}},{"range":{"@timestamp":{"from":"{{period_end}}||-70s","to":"{{period_end}}||-10s","include_lower":true,"include_upper":true,"format":"epoch_millis","boost":1.0}}}],"adjust_pure_negative":true,"boost":1.0}}}}}],"triggers":[{"query_level_trigger":{"id":"6kUPMI0BPQCiAxDIPDKg","name":"High Usage","severity":"1","condition":{"script":{"source":"def WARNING_THRESHOLD = 90;\ndef ERROR_THRESHOLD = 90;\nboolean TRIGGER_RESULT = false;\n\nfor (hit in ctx.results[0].hits.hits) {\n    def hostMemory = hit._source.system.memory.used.pct*100;\n    def hostName = hit._source.host.name;\n    if (hostMemory >= WARNING_THRESHOLD) {\n        if (hostMemory >= ERROR_THRESHOLD) {\n            hit.alert_error = true;\n            hit.threshold_value = Math.round(ERROR_THRESHOLD * 100.0) / 100.0;\n        } else {\n            hit.alert_warning = true;\n            hit.threshold_value = Math.round(WARNING_THRESHOLD * 100.0) / 100.0;\n        }\n        TRIGGER_RESULT = true;\n        hit.include_result = true;\n        hit.clientName = hit._source.client.name;\n        hit.platformName = hit._source.platform.name;\n        hit.hostName = hostName;\n        hit.observed_value = Math.round(hostMemory * 100.0) / 100.0;\n        hit.eventTime = hit._source['@timestamp'];\n        def sdf = DateTimeFormatter.ofPattern(\"yyyy-MM-dd'T'HH:mm:ss.SSSX\");\n        def timestamp = ZonedDateTime.parse(hit._source['@timestamp'], sdf);\n        ZonedDateTime startOfDay = timestamp.toLocalDate().atStartOfDay(timestamp.getZone());\n        hit.startTime = startOfDay.toInstant().toEpochMilli();\n        ZonedDateTime endOfDay = startOfDay.plusHours(23).plusMinutes(59).plusSeconds(59);\n        hit.endTime = endOfDay.toInstant().toEpochMilli();\n    }\n}\n\n\nreturn TRIGGER_RESULT;","lang":"painless"}},"actions":[{"id":"notification692966","name":"Arnav boula raha hai","destination_id":"tZZnKIgBynr6KVOG7W-k","message_template":{"source":"Monitor {{ctx.monitor.name}} just entered alert status. Please investigate the issue.\n  - Trigger: {{ctx.trigger.name}}\n  - Severity: {{ctx.trigger.severity}}\n  - Period start: {{ctx.periodStart}}\n  - Period end: {{ctx.periodEnd}}","lang":"mustache"},"throttle_enabled":false,"subject_template":{"source":"Alerting Notification action","lang":"mustache"}}]}}],"last_update_time":1705992667060,"data_sources":{"query_index":".opensearch-alerting-queries","findings_index":".opensearch-alerting-finding-history-write","findings_index_pattern":"<.opensearch-alerting-finding-history-{now/d}-1>","alerts_index":".opendistro-alerting-alerts","alerts_history_index":".opendistro-alerting-alert-history-write","alerts_history_index_pattern":"<.opendistro-alerting-alert-history-{now/d}-1>","query_index_mappings_by_type":{},"findings_enabled":false},"owner":"alerting"},"associated_workflows":[]}